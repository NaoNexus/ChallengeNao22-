<!DOCTYPE html>
<html lang="en">

<head>
    <title>Reports</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(() => { drawChart('co2') });

        select.addEventListener('click', ({ target }) => { // handler fires on root container click
            if (target.getAttribute('name') === 'btnradio') { // check if user clicks right element
                drawChart(target.value)
            }
        });

        function drawChart(viewData) {
            var data = new google.visualization.DataTable();
            data.addColumn('date', 'Date');
            data.addColumn('number', 'CO2');
            data.addColumn('number', 'Temperature');
            data.addColumn('number', 'Humidity');

            data.addRows([
                {% for report in reports %}
        [new Date("{{ report['date']}}"), {{ report['co2'] }}, {{ report['temperature'] }}, {{ report['humidity'] }}],
            {% endfor %}
            ]);

        var view = new google.visualization.DataView(data);

        switch (viewData) {
            case 'co2':
                view.hideColumns([2, 3]);
                break;
            case 'temperature':
                view.hideColumns([1, 3]);
                break;
            case 'humidity':
                view.hideColumns([1, 2]);
                break;
            default:
                view.hideColumns([2, 3]);
                break;
        }

        var options = {
            title: 'Sensor reports',
            curveType: 'function',
            legend: { position: 'bottom' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

        chart.draw(view, options);
        }
    </script>
</head>

<body>
    <h1>Reports</h1>
    <div id="curve_chart" style="width: 100%; height: 500px"></div>
    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
        <input type="radio" class="btn-check" name="btnradio" id="co2_radio" autocomplete="off" checked value="co2">
        <label class="btn btn-outline-primary" for="btnradio1">CO2</label>

        <input type="radio" class="btn-check" name="btnradio" id="temperature_radio" autocomplete="off"
            value="temperature">
        <label class="btn btn-outline-primary" for="btnradio2">Temperature</label>

        <input type="radio" class="btn-check" name="btnradio" id="humidity_radio" autocomplete="off" value="humidity">
        <label class="btn btn-outline-primary" for="btnradio3">Humidity</label>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Date</th>
                <th scope="col">CO2</th>
                <th scope="col">Temperature</th>
                <th scope="col">Humidity</th>
            </tr>
        </thead>
        <tbody>
            {% for report in reports %}
            <tr>
                <th scope="row">{{report['id']}}</th>
                <td>{{report['date']}}</td>
                <td>{{report['co2']}}</td>
                <td>{{report['temperature']}}</td>
                <td>{{report['humidity']}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>

</html>